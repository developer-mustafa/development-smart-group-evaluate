import{j as e}from"./ui-vendor-Cdlq2rUE.js";import{a}from"./react-vendor-BDWLk7Fa.js";import{a as s,u as t,c as r,b as d}from"./index-BxVb7EoU.js";import"./redux-vendor-s_JgMA9B.js";import"./utils-vendor-D5b2lksY.js";function l(){const[l,i]=a.useState({groupId:"",minScore:"",maxScore:"",taskId:"",search:""}),{data:c}=s({}),{data:n}=t(),{data:o}=r(),{data:x}=d(),m=c?.data||[],p=n?.data||[],u=o?.data||[],h=x?.data||[],g=a.useMemo(()=>m.filter(e=>{if(l.groupId&&(e.group?._id||e.group)!==l.groupId)return!1;if(l.search){const a=l.search.toLowerCase();if(!e.name.toLowerCase().includes(a)&&!e.roll?.toLowerCase().includes(a))return!1}if(l.taskId&&(l.minScore||l.maxScore)){const a=u.find(a=>!(a.member?._id!==e._id&&a.member!==e._id||a.task?._id!==l.taskId&&a.task!==l.taskId));a&&a.totalScore;let s=0;if(a&&a.scores&&a.scores[e._id]&&(s=a.scores[e._id].totalScore||0),l.minScore&&s<parseFloat(l.minScore))return!1;if(l.maxScore&&s>parseFloat(l.maxScore))return!1}return!0}),[m,u,l]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-purple-600 to-indigo-500 bg-clip-text text-transparent",children:"শিক্ষার্থী ফিল্টার"}),e.jsxs("button",{onClick:()=>{const e="data:text/csv;charset=utf-8,Name,Roll,Group,Email,Contact\n"+g.map(e=>`${e.name},${e.roll},${e.group?.name||"-"},${e.email||"-"},${e.contact||"-"}`).join("\n"),a=encodeURI(e),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","filtered_students.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},className:"btn btn-primary",children:[e.jsx("i",{className:"fa fa-download mr-2"}),"এক্সপোর্ট CSV"]})]}),e.jsxs("div",{className:"card card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"গ্রুপ"}),e.jsxs("select",{className:"form-input",value:l.groupId,onChange:e=>i(a=>({...a,groupId:e.target.value})),children:[e.jsx("option",{value:"",children:"সব গ্রুপ"}),p.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"নাম বা রোল"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"খুঁজুন...",value:l.search,onChange:e=>i(a=>({...a,search:e.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"টাস্ক (স্কোর ফিল্টারের জন্য)"}),e.jsxs("select",{className:"form-input",value:l.taskId,onChange:e=>i(a=>({...a,taskId:e.target.value})),children:[e.jsx("option",{value:"",children:"টাস্ক নির্বাচন করুন"}),h.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]})]}),l.taskId&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pt-4 border-t dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"সর্বনিম্ন স্কোর"}),e.jsx("input",{type:"number",className:"form-input",value:l.minScore,onChange:e=>i(a=>({...a,minScore:e.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"সর্বোচ্চ স্কোর"}),e.jsx("input",{type:"number",className:"form-input",value:l.maxScore,onChange:e=>i(a=>({...a,maxScore:e.target.value}))})]})]})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"নাম"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"রোল"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"গ্রুপ"}),l.taskId&&e.jsxs("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:["স্কোর (",h.find(e=>e._id===l.taskId)?.name,")"]}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase",children:"স্ট্যাটাস"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:g.length>0?g.map(a=>{let s="-";if(l.taskId){const e=u.find(e=>!(e.task?._id!==l.taskId&&e.task!==l.taskId||e.group?._id!==a.group?._id&&e.group!==a.group));e&&e.scores&&e.scores[a._id]&&(s=e.scores[a._id].totalScore)}return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"px-6 py-4 font-medium",children:a.name}),e.jsx("td",{className:"px-6 py-4",children:a.roll}),e.jsx("td",{className:"px-6 py-4",children:a.group?.name||"-"}),l.taskId&&e.jsx("td",{className:"px-6 py-4 text-center font-bold text-blue-600 dark:text-blue-400",children:s}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.isActive?"সক্রিয়":"নিষ্ক্রিয়"})})]},a._id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:l.taskId?5:4,className:"px-6 py-8 text-center text-gray-500",children:"কোনো শিক্ষার্থী পাওয়া যায়নি"})})})]})})})]})}export{l as default};
