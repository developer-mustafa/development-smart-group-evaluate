import{j as e}from"./ui-vendor-Cdlq2rUE.js";import{a}from"./react-vendor-BDWLk7Fa.js";import{b as s,n as t,o as l,p as r}from"./index-BxVb7EoU.js";import{C as n}from"./redux-vendor-s_JgMA9B.js";import"./utils-vendor-D5b2lksY.js";function i(){const{user:i}=n(e=>e.auth),[d,c]=a.useState(!1),[m,x]=a.useState(null),[o,u]=a.useState({name:"",description:"",dueDate:"",scheduledTime:"",status:"upcoming",maxScoreBreakdown:{task:20,team:15,additional:25,mcq:40},maxScore:100}),{data:p,isLoading:h}=s(),[g]=t(),[j]=l(),[b]=r(),f=p?.data||[],N=i?.permissions?.write||i?.permissions?.edit,v=i?.permissions?.delete;a.useEffect(()=>{const{task:e,team:a,additional:s,mcq:t}=o.maxScoreBreakdown,l=Number(e)+Number(a)+Number(s)+Number(t);u(e=>({...e,maxScore:l}))},[o.maxScoreBreakdown]);const y=(e,a)=>{u(s=>({...s,maxScoreBreakdown:{...s.maxScoreBreakdown,[e]:Number(a)}}))},k=()=>{u({name:"",description:"",dueDate:"",scheduledTime:"",status:"upcoming",maxScoreBreakdown:{task:20,team:15,additional:25,mcq:40},maxScore:100})},w=a=>{switch(a){case"upcoming":return e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-200",children:"আপকামিং"});case"ongoing":return e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200",children:"চলমান"});case"completed":return e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200",children:"সম্পন্ন"});default:return null}};return h?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"loading-spinner"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"টাস্ক ম্যানেজমেন্ট"}),e.jsxs("p",{className:"text-sm md:text-base text-gray-500 dark:text-gray-400",children:["মোট টাস্ক: ",f.length]})]}),N&&e.jsxs("button",{onClick:()=>{k(),c(!0)},className:"btn btn-primary",children:[e.jsx("i",{className:"fa fa-plus mr-2"}),"নতুন টাস্ক"]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e={...o,maxScore:Number(o.maxScore)};m?await j({id:m._id,...e}).unwrap():await g(e).unwrap(),c(!1),x(null),k()}catch(a){alert(a.data?.message||"Operation failed")}},className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:m?"টাস্ক সম্পাদনা":"নতুন টাস্ক"}),e.jsx("button",{type:"button",onClick:()=>{c(!1),x(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"fa fa-times"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"টাস্ক নাম *"}),e.jsx("input",{type:"text",value:o.name,onChange:e=>u({...o,name:e.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"বিবরণ"}),e.jsx("textarea",{value:o.description,onChange:e=>u({...o,description:e.target.value}),className:"form-input",rows:"3"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"তারিখ *"}),e.jsx("input",{type:"date",value:o.dueDate,onChange:e=>u({...o,dueDate:e.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"সময় (ঐচ্ছিক)"}),e.jsx("input",{type:"time",value:o.scheduledTime,onChange:e=>u({...o,scheduledTime:e.target.value}),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"স্ট্যাটাস"}),e.jsxs("select",{value:o.status,onChange:e=>u({...o,status:e.target.value}),className:"form-input",children:[e.jsx("option",{value:"upcoming",children:"আপকামিং"}),e.jsx("option",{value:"ongoing",children:"চলমান"}),e.jsx("option",{value:"completed",children:"সম্পন্ন"})]})]})]}),e.jsxs("div",{className:"border p-4 rounded-lg bg-gray-50 dark:bg-gray-700/30",children:[e.jsx("h3",{className:"font-semibold mb-3 text-sm uppercase text-gray-500",children:"স্কোর ব্রেকডাউন"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"টাস্ক"}),e.jsx("input",{type:"number",min:"0",value:o.maxScoreBreakdown.task,onChange:e=>y("task",e.target.value),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"টিম"}),e.jsx("input",{type:"number",min:"0",value:o.maxScoreBreakdown.team,onChange:e=>y("team",e.target.value),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"অতিরিক্ত"}),e.jsx("input",{type:"number",min:"0",value:o.maxScoreBreakdown.additional,onChange:e=>y("additional",e.target.value),className:"form-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"MCQ"}),e.jsx("input",{type:"number",min:"0",value:o.maxScoreBreakdown.mcq,onChange:e=>y("mcq",e.target.value),className:"form-input"})]})]}),e.jsx("div",{className:"mt-3 text-right",children:e.jsxs("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-300",children:["মোট স্কোর: ",o.maxScore]})})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{c(!1),x(null)},className:"btn btn-secondary flex-1",children:"বাতিল"}),e.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:m?"আপডেট":"তৈরি"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:f.map(a=>e.jsx("div",{className:"card p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:a.name}),w(a.status)]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400 mb-3",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa fa-calendar"}),a.dueDate?new Date(a.dueDate).toLocaleDateString("bn-BD"):"N/A"]}),a.scheduledTime&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fa fa-clock"}),a.scheduledTime]}),e.jsxs("span",{className:"flex items-center gap-1 font-semibold text-purple-600 dark:text-purple-400",children:[e.jsx("i",{className:"fa fa-star"}),"মোট স্কোর: ",a.maxScore]})]}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex gap-2 text-xs bg-gray-100 dark:bg-gray-700/50 p-2 rounded-lg w-fit",children:[e.jsxs("span",{title:"Task Score",children:["T: ",a.maxScoreBreakdown?.task||0]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{title:"Team Score",children:["Tm: ",a.maxScoreBreakdown?.team||0]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{title:"Additional Score",children:["A: ",a.maxScoreBreakdown?.additional||0]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{title:"MCQ Score",children:["M: ",a.maxScoreBreakdown?.mcq||0]})]})]}),e.jsxs("div",{className:"flex items-start gap-2 min-w-fit",children:[N&&e.jsx("button",{onClick:()=>(e=>{x(e),u({name:e.name,description:e.description||"",dueDate:e.dueDate?new Date(e.dueDate).toISOString().split("T")[0]:"",scheduledTime:e.scheduledTime||"",status:e.status||"upcoming",maxScoreBreakdown:e.maxScoreBreakdown||{task:0,team:0,additional:0,mcq:0},maxScore:e.maxScore||0}),c(!0)})(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"সম্পাদনা",children:e.jsx("i",{className:"fa fa-edit"})}),v&&e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure?"))try{await b(e).unwrap()}catch(a){alert(a.data?.message||"Delete failed")}})(a._id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"মুছে ফেলুন",children:e.jsx("i",{className:"fa fa-trash"})})]})]})},a._id))}),0===f.length&&e.jsxs("div",{className:"card card-body text-center py-12",children:[e.jsx("i",{className:"fa fa-tasks text-6xl text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"কোনো টাস্ক নেই"})]})]})}export{i as default};
