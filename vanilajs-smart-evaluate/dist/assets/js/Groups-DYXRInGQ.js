import{j as e}from"./ui-vendor-Cdlq2rUE.js";import{a}from"./react-vendor-BDWLk7Fa.js";import{u as s,h as t,i as r,j as l}from"./index-BxVb7EoU.js";import{C as i}from"./redux-vendor-s_JgMA9B.js";import{G as d}from"./GroupDetailModal-BlI9tid9.js";import"./utils-vendor-D5b2lksY.js";function n({group:s,onEdit:t,onDelete:r}){const[l,i]=a.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card hover:shadow-lg transition-shadow duration-200",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>i(!0),children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-1 hover:text-blue-600 dark:hover:text-blue-400",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[t&&e.jsx("button",{onClick:()=>t(s),className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"সম্পাদনা",children:e.jsx("i",{className:"fa fa-edit"})}),r&&e.jsx("button",{onClick:()=>r(s._id),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"মুছে ফেলুন",children:e.jsx("i",{className:"fa fa-trash"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700 cursor-pointer",onClick:()=>i(!0),children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"সদস্য"}),e.jsx("div",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:s.memberCount||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"অবস্থা"}),e.jsx("div",{className:"text-xl font-bold",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(s.isActive?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300"),children:s.isActive?"সক্রিয়":"নিষ্ক্রিয়"})})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("i",{className:"fa fa-calendar mr-1"}),"তৈরি: ",new Date(s.createdAt).toLocaleDateString("bn-BD")]})]})}),l&&e.jsx(d,{group:s,onClose:()=>i(!1)})]})}function c({group:s,onSubmit:t,onCancel:r}){const[l,i]=a.useState({name:"",description:"",isActive:!0}),[d,n]=a.useState(!1);a.useEffect(()=>{s&&i({name:s.name||"",description:s.description||"",isActive:void 0===s.isActive||s.isActive})},[s]);return e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{await t(l)}finally{n(!1)}},className:"p-6",children:[e.jsxs("div",{className:" flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:s?"গ্রুপ সম্পাদনা":"নতুন গ্রুপ"}),e.jsx("button",{type:"button",onClick:r,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx("i",{className:"fa fa-times"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"গ্রুপের নাম *"}),e.jsx("input",{type:"text",value:l.name,onChange:e=>i({...l,name:e.target.value}),className:"form-input",placeholder:"যেমন: Group A",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"বিবরণ"}),e.jsx("textarea",{value:l.description,onChange:e=>i({...l,description:e.target.value}),className:"form-input",rows:"3",placeholder:"গ্রুপ সম্পর্কে বিস্তারিত লিখুন..."})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:l.isActive,onChange:e=>i({...l,isActive:e.target.checked}),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"সক্রিয় গ্রুপ"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary",disabled:d,children:"বাতিল"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d,children:d?"সংরক্ষণ হচ্ছে...":s?"আপডেট করুন":"তৈরি করুন"})]})]})}function o(){const{user:d}=i(e=>e.auth),[o,x]=a.useState(!1),[m,u]=a.useState(null),[g,h]=a.useState(""),{data:p,isLoading:b,error:j}=s(),[y]=t(),[v]=r(),[f]=l(),N=p?.data||[],k=d?.permissions?.write||d?.permissions?.edit,w=d?.permissions?.delete,C=N.filter(e=>e.name.toLowerCase().includes(g.toLowerCase())||e.description?.toLowerCase().includes(g.toLowerCase())),A=async e=>{if(confirm("Are you sure you want to delete this group?"))try{await f(e).unwrap()}catch(a){alert(a.data?.message||"Failed to delete group")}};return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loading-spinner"})}):j?e.jsx("div",{className:"card card-body",children:e.jsxs("p",{className:"text-red-600",children:["Error loading groups: ",j.data?.message||"Unknown error"]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"গ্রুপ ম্যানেজমেন্ট"}),e.jsxs("p",{className:"text-sm md:text-base text-gray-500 dark:text-gray-400",children:["মোট গ্রুপ: ",N.length]})]}),k&&e.jsxs("button",{onClick:()=>{u(null),x(!0)},className:"btn btn-primary",children:[e.jsx("i",{className:"fa fa-plus mr-2"}),"নতুন গ্রুপ"]})]}),e.jsx("div",{className:"card card-body",children:e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa fa-search absolute left-3 top-3.5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"গ্রুপ খুঁজুন...",value:g,onChange:e=>h(e.target.value),className:"form-input pl-10"})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(c,{group:m,onSubmit:e=>{m?(async(e,a)=>{try{await v({id:e,...a}).unwrap(),u(null),x(!1)}catch(s){alert(s.data?.message||"Failed to update group")}})(m._id,e):(async e=>{try{await y(e).unwrap(),x(!1)}catch(a){alert(a.data?.message||"Failed to create group")}})(e)},onCancel:()=>{x(!1),u(null)}})})}),0===C.length?e.jsxs("div",{className:"card card-body text-center py-12",children:[e.jsx("i",{className:"fa fa-layer-group text-6xl text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:g?"কোনো গ্রুপ পাওয়া যায়নি":"এখনো কোনো গ্রুপ তৈরি হয়নি"}),k&&!g&&e.jsx("button",{onClick:()=>x(!0),className:"btn btn-primary mt-4 mx-auto",children:"প্রথম গ্রুপ তৈরি করুন"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(a=>e.jsx(n,{group:a,onEdit:k?e=>{u(e),x(!0)}:null,onDelete:w?A:null},a._id))})]})}export{o as default};
