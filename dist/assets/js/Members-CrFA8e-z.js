import{j as e}from"./ui-vendor-Cdlq2rUE.js";import{a}from"./react-vendor-BDWLk7Fa.js";import{u as s,a as l,k as t,l as r,m as i}from"./index-BxVb7EoU.js";import{C as n}from"./redux-vendor-s_JgMA9B.js";import{M as c}from"./MemberTable-zip0Dbo9.js";import"./utils-vendor-D5b2lksY.js";import"./StudentDetailModal-reJEotCq.js";import"./table-CmieK8SB.js";function d({member:l,onSubmit:t,onCancel:r}){const{data:i}=s(),n=i?.data||[],[c,d]=a.useState({name:"",roll:"",email:"",gender:"",contact:"",academicGroup:"",session:"",role:"",groupId:"",isActive:!0}),[o,m]=a.useState(!1);a.useEffect(()=>{l&&d({name:l.name||"",roll:l.roll||"",email:l.email||"",gender:l.gender||"",contact:l.contact||"",academicGroup:l.academicGroup||"",session:l.session||"",role:l.role||"",groupId:l.groupId||l.group?._id||"",isActive:void 0===l.isActive||l.isActive})},[l]);return e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m(!0);try{await t(c)}finally{m(!1)}},className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:l?"সদস্য সম্পাদনা":"নতুন সদস্য"}),e.jsx("button",{type:"button",onClick:r,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx("i",{className:"fa fa-times"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx("label",{className:"label",children:"নাম *"}),e.jsx("input",{type:"text",value:c.name,onChange:e=>d({...c,name:e.target.value}),className:"form-input",placeholder:"শিক্ষার্থীর নাম",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"রোল নম্বর *"}),e.jsx("input",{type:"text",value:c.roll,onChange:e=>d({...c,roll:e.target.value}),className:"form-input",placeholder:"যেমন: 101",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ইমেইল"}),e.jsx("input",{type:"email",value:c.email,onChange:e=>d({...c,email:e.target.value}),className:"form-input",placeholder:"student@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"মোবাইল নম্বর"}),e.jsx("input",{type:"text",value:c.contact,onChange:e=>d({...c,contact:e.target.value}),className:"form-input",placeholder:"017XXXXXXXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"লিঙ্গ *"}),e.jsxs("select",{value:c.gender,onChange:e=>d({...c,gender:e.target.value}),className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"নির্বাচন করুন"}),e.jsx("option",{value:"ছেলে",children:"ছেলে"}),e.jsx("option",{value:"মেয়ে",children:"মেয়ে"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"বিভাগ (Group)"}),e.jsxs("select",{value:c.academicGroup,onChange:e=>d({...c,academicGroup:e.target.value}),className:"form-input",children:[e.jsx("option",{value:"",children:"নির্বাচন করুন"}),e.jsx("option",{value:"Science",children:"Science"}),e.jsx("option",{value:"Arts",children:"Arts"}),e.jsx("option",{value:"Commerce",children:"Commerce"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"সেশন"}),e.jsx("input",{type:"text",value:c.session,onChange:e=>d({...c,session:e.target.value}),className:"form-input",placeholder:"যেমন: 2023-24"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"টিম রোল"}),e.jsxs("select",{value:c.role,onChange:e=>d({...c,role:e.target.value}),className:"form-input",children:[e.jsx("option",{value:"",children:"নির্বাচন করুন"}),e.jsx("option",{value:"team-leader",children:"Team Leader"}),e.jsx("option",{value:"time-keeper",children:"Time Keeper"}),e.jsx("option",{value:"reporter",children:"Reporter"}),e.jsx("option",{value:"resource-manager",children:"Resource Manager"}),e.jsx("option",{value:"peace-maker",children:"Peace Maker"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"গ্রুপ"}),e.jsxs("select",{value:c.groupId,onChange:e=>d({...c,groupId:e.target.value}),className:"form-input",children:[e.jsx("option",{value:"",children:"গ্রুপ নির্বাচন করুন"}),n.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]}),e.jsxs("div",{className:"flex items-center pt-8",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:c.isActive,onChange:e=>d({...c,isActive:e.target.checked}),className:"w-4 h-4 text-blue-600 rounded"}),e.jsx("label",{htmlFor:"isActive",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"সক্রিয় সদস্য"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:r,className:"btn btn-secondary",disabled:o,children:"বাতিল"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"সংরক্ষণ হচ্ছে...":l?"আপডেট করুন":"তৈরি করুন"})]})]})}function o(){const{user:s}=n(e=>e.auth),[o,m]=a.useState(!1),[u,x]=a.useState(null),[p,h]=a.useState({groupId:"",search:""}),{data:j,isLoading:v}=l(p),[g]=t(),[b]=r(),[f]=i(),N=j?.data||[],y=s?.permissions?.write||s?.permissions?.edit,C=s?.permissions?.delete;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white",children:"সদস্য ম্যানেজমেন্ট"}),e.jsxs("p",{className:"text-sm md:text-base text-gray-500 dark:text-gray-400",children:["মোট সদস্য: ",j?.count||0]})]}),y&&e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary",children:[e.jsx("i",{className:"fa fa-user-plus mr-2"}),"নতুন সদস্য"]})]}),e.jsx("div",{className:"card card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"নাম বা ইমেইল দিয়ে খুঁজুন...",value:p.search,onChange:e=>h({...p,search:e.target.value}),className:"form-input"})})})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsx(d,{member:u,onSubmit:e=>{u?(async(e,a)=>{try{await b({id:e,...a}).unwrap(),x(null),m(!1)}catch(s){alert(s.data?.message||"Failed to update member")}})(u._id,e):(async e=>{try{await g(e).unwrap(),m(!1)}catch(a){alert(a.data?.message||"Failed to create member")}})(e)},onCancel:()=>{m(!1),x(null)}})})}),v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"loading-spinner"})}):e.jsx(c,{members:N,onEdit:y?e=>{x(e),m(!0)}:null,onDelete:C?async e=>{if(confirm("Are you sure you want to delete this member?"))try{await f(e).unwrap()}catch(a){alert(a.data?.message||"Failed to delete member")}}:null})]})}export{o as default};
