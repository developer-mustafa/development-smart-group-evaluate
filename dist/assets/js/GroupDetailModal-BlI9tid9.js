import{j as e}from"./ui-vendor-Cdlq2rUE.js";import{a as r}from"./react-vendor-BDWLk7Fa.js";import{c as t,a,u as d}from"./index-BxVb7EoU.js";const s=e=>({"team-leader":"টিম লিডার","time-keeper":"টাইম কিপার",reporter:"রিপোর্টার","resource-manager":"রিসোর্স ম্যানেজার","peace-maker":"পিস মেকার"}[e]||e),l=e=>{if(!e)return"hidden";const r=["bg-emerald-50 text-emerald-700 border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-700","bg-indigo-50 text-indigo-700 border-indigo-200 dark:bg-indigo-900/30 dark:text-indigo-300 dark:border-indigo-700","bg-rose-50 text-rose-700 border-rose-200 dark:bg-rose-900/30 dark:text-rose-300 dark:border-rose-700","bg-amber-50 text-amber-700 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-700","bg-sky-50 text-sky-700 border-sky-200 dark:bg-sky-900/30 dark:text-sky-300 dark:border-sky-700"];let t=0;for(let a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);return r[Math.abs(t)%r.length]},x=e=>e>=85?"bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300":e>=70?"bg-sky-50 text-sky-700 dark:bg-sky-900/30 dark:text-sky-300":e>=55?"bg-amber-50 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300":"bg-rose-50 text-rose-700 dark:bg-rose-900/30 dark:text-rose-300";function o({group:o,onClose:i}){const[c,n]=r.useState("members"),[m,g]=r.useState(0),{data:b}=t(),{data:p}=a(),{data:h}=d(),y=r.useMemo(()=>b?.data||[],[b]),k=r.useMemo(()=>p?.data||[],[p]),u=r.useMemo(()=>h?.data||[],[h]),j=r.useMemo(()=>y.filter(e=>e.group?._id===o._id||e.group===o._id).sort((e,r)=>new Date(r.createdAt)-new Date(e.createdAt)),[y,o._id]),N=r.useMemo(()=>k.filter(e=>e.group?._id===o._id||e.group===o._id),[k,o._id]),f=r.useMemo(()=>{if(!j.length)return 0;return(j.reduce((e,r)=>e+(r.groupAverageScore||0),0)/j.length).toFixed(1)},[j]),v=r.useMemo(()=>{if(!u.length||!y.length)return"-";const e=u.map(e=>{const r=y.filter(r=>r.group?._id===e._id||r.group===e._id);if(!r.length)return{id:e._id,avg:0};const t=r.reduce((e,r)=>e+(r.groupAverageScore||0),0)/r.length;return{id:e._id,avg:t}}).sort((e,r)=>r.avg-e.avg).findIndex(e=>e.id===o._id)+1;return e>0?e:"-"},[u,y,o._id]),w=j[m],S=r.useMemo(()=>w?N.map(e=>{const r=w.scores?.[e._id]||{},t=parseFloat(r.taskScore)||0,a=parseFloat(r.teamScore)||0,d=parseFloat(r.additionalScore)||0,s=parseFloat(r.mcqScore)||0,l=parseFloat(r.totalScore)||t+a+d+s,x=w.task?.maxScore||100,o=x>0?l/x*100:0;return{...e,taskScore:t,teamScore:a,additional:d,mcq:s,total:l,pct:o,comment:r.comments||""}}).sort((e,r)=>r.pct-e.pct):[],[N,w]);return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b dark:border-gray-700 flex justify-between items-start bg-gray-50 dark:bg-gray-900/50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center text-3xl font-bold text-indigo-600 dark:text-indigo-400 shadow-sm",children:e.jsx("i",{className:"fa fa-users"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm",children:[e.jsxs("span",{className:"px-2 py-0.5 rounded-md bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 font-medium",children:["গড়: ",f,"%"]}),e.jsxs("span",{className:"px-2 py-0.5 rounded-md bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 font-medium",children:["র‍্যাংক: ",v]}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["সদস্য: ",N.length]})]})]})]}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors",children:e.jsx("i",{className:"fa fa-times text-xl"})})]}),e.jsxs("div",{className:"flex border-b dark:border-gray-700 px-6",children:[e.jsx("button",{onClick:()=>n("members"),className:"px-4 py-3 font-medium text-sm transition-colors border-b-2 "+("members"===c?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"),children:"সদস্যদের ফলাফল"}),e.jsx("button",{onClick:()=>n("evaluations"),className:"px-4 py-3 font-medium text-sm transition-colors border-b-2 "+("evaluations"===c?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"),children:"মূল্যায়ন ইতিহাস"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50/50 dark:bg-gray-800",children:["members"===c&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white dark:bg-gray-700 p-3 rounded-lg border dark:border-gray-600 shadow-sm",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"অ্যাসাইনমেন্ট নির্বাচন:"}),e.jsxs("select",{value:m,onChange:e=>g(Number(e.target.value)),className:"form-select flex-1 text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white rounded-md focus:ring-blue-500 focus:border-blue-500",children:[j.map((r,t)=>e.jsxs("option",{value:t,children:[r.task?.name," (",new Date(r.createdAt).toLocaleDateString("bn-BD"),")"]},r._id)),0===j.length&&e.jsx("option",{children:"কোনো মূল্যায়ন নেই"})]})]}),w?e.jsx("div",{className:"bg-white dark:bg-gray-700 rounded-lg border dark:border-gray-600 overflow-hidden shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 font-semibold border-b dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"রোল"}),e.jsx("th",{className:"px-4 py-3",children:"ভূমিকা"}),e.jsx("th",{className:"px-4 py-3",children:"নাম"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"টাস্ক"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"টিম"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"অতিরিক্ত"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"MCQ"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"মোট"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"%"}),e.jsx("th",{className:"px-4 py-3",children:"মন্তব্য"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-600",children:S.map(r=>{return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-600/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-gray-500 dark:text-gray-400",children:r.roll}),e.jsx("td",{className:"px-4 py-3",children:r.role&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium border ${t=r.role,{"team-leader":"bg-amber-50 text-amber-700 border-amber-200 dark:bg-amber-900/30 dark:text-amber-300 dark:border-amber-700","time-keeper":"bg-sky-50 text-sky-700 border-sky-200 dark:bg-sky-900/30 dark:text-sky-300 dark:border-sky-700",reporter:"bg-purple-50 text-purple-700 border-purple-200 dark:bg-purple-900/30 dark:text-purple-300 dark:border-purple-700","resource-manager":"bg-emerald-50 text-emerald-700 border-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-300 dark:border-emerald-700","peace-maker":"bg-rose-50 text-rose-700 border-rose-200 dark:bg-rose-900/30 dark:text-rose-300 dark:border-rose-700"}[t]||"bg-gray-50 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600"}`,children:s(r.role)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r.name}),r.academicGroup&&e.jsx("span",{className:`px-1.5 py-0.5 text-[10px] rounded border ${l(r.academicGroup)}`,children:r.academicGroup})]})}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-600 dark:text-gray-300",children:r.taskScore}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-600 dark:text-gray-300",children:r.teamScore}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-600 dark:text-gray-300",children:r.additional}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-600 dark:text-gray-300",children:r.mcq}),e.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900 dark:text-white",children:r.total}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${x(r.pct)}`,children:[r.pct.toFixed(0),"%"]})}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-500 dark:text-gray-400 max-w-[200px] truncate",title:r.comment,children:r.comment})]},r._id);var t})})]})})}):e.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"কোনো ডেটা পাওয়া যায়নি"})]}),"evaluations"===c&&e.jsx("div",{className:"bg-white dark:bg-gray-700 rounded-lg border dark:border-gray-600 overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 font-semibold border-b dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"অ্যাসাইনমেন্ট"}),e.jsx("th",{className:"px-4 py-3",children:"তারিখ"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"সদস্য"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"গড় স্কোর"}),e.jsx("th",{className:"px-4 py-3",children:"সেরা পারফর্মার"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-600",children:[j.map(r=>{let t="-",a=-1;return r.scores&&Object.entries(r.scores).forEach(([e,r])=>{if(r.totalScore>a){a=r.totalScore;const d=N.find(r=>r._id===e);d&&(t=d.name)}}),e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-600/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:r.task?.name}),e.jsx("td",{className:"px-4 py-3 text-gray-500 dark:text-gray-400",children:new Date(r.createdAt).toLocaleDateString("bn-BD")}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-600 dark:text-gray-300",children:Object.keys(r.scores||{}).length}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${x(r.groupAverageScore)}`,children:[r.groupAverageScore,"%"]})}),e.jsx("td",{className:"px-4 py-3 text-gray-600 dark:text-gray-300",children:t})]},r._id)}),0===j.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:"কোনো মূল্যায়ন ইতিহাস নেই"})})]})]})})]})]})})}export{o as G};
